version: '3.8'

services:
  steamshine:
    build: .
    image: ghcr.io/${GITHUB_REPOSITORY:-cmmmota/steamshine}
    volumes:
      - steam-data:/home/steamshine/.steam
      - sunshine-config:/home/steamshine/.config/sunshine
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=all
      - STEAM_RUNTIME=0
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

volumes:
  steam-data:
    name: steamshine-steam-data
  sunshine-config:
    name: steamshine-sunshine-config 